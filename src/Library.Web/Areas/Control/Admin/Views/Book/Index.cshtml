@model BookListingViewModel

<div class="card">
    <div class="card-header pt-2 pb-0">
        <h2 class="float-left">Books</h2>
        <a class="float-right btn btn-primary" asp-action="Create" asp-controller="Book">Add Book</a>
    </div>
        <div class="card-block"> 
@if(Model.Books.Count > 0)    
{
       
        <form id="sort-filter-form" class="form-horizontal">
             <div class="row form-group">                
                <div class="col-sm-12 col-md-3">
                    <label asp-for="SortFilterPageData.FilterBy" class="col-form-label">Filter By</label>
                    <select asp-for="SortFilterPageData.FilterBy" name="FilterBy" asp-items="Html.GetEnumSelectList<BooksFilterBy>()" class="form-control" onchange="BookClientManager.filterByHasChanged(this)">                    
                    </select>
                </div>
                <div class="col-sm-12 col-md-4 dim-filter-value" id="filter-value-group">
                    <label asp-for="SortFilterPageData.FilterValue" class="col-form-label">Filter Value</label>
                    <select asp-for="SortFilterPageData.FilterValue" name="FilterValue" class="form-control" id="filter-value-dropdown" onchange="BookClientManager.submitForm(this)">
                        <option>Select filter type...</option>
                    </select>
                </div>
             </div>
        </form>
        <hr>
       

        @foreach(var item in Model.Books) {
            <div class="row">
                <div class="col-sm-12 col-md-1">
                    <img src="@Url.Content(@item.Cover.Path)" alt="@item.Title" title="@item.Title" style="width: 80px; height: 80px">
                </div>
                <div class="col-sm-12 col-md-11">                     
                    <div class="row">
                        <h4 class="col-sm-12">@item.Title</h4>
                    </div>
                     <div class="row">
                        <div class="col-sm-12 col-md-10">
                            by @string.Join(", ", item.AuthorsLink.Select(al => al.Author.LastName + " " + al.Author.FirstName[0]).ToList())
                        </div>                    
                        <div class="col-sm-12 col-md-2">
                            <div class="btn-group">
                                <a asp-action="BookBasic" asp-controller="Book" asp-route-id="@item.Id" class="btn btn-primary btn-sm">details</a>
                            </div>  
                        </div>
                    </div>
                </div>
                                                
            </div>
            
            
        <hr>
        }
   
}
else
{
    <h3>No book has been entered</h3>
}
 </div>
</div>


@Html.Partial("_Modal", new BootstrapModel { ID = "modal-action-book", AreaLabeledId = "modal-action-book-label", Size = ModalSize.Medium })


@section scripts {
    <script src="~/js/modal.js" asp-append-version="true"></script>
    <script src="~/js/bookClientManager.js" asp-append-version="true"></script>
    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function() {            
            Modal.init("modal-action-book");
            BookClientManager.initialize('@Model.SortFilterPageData.FilterBy','@Model.SortFilterPageData.FilterValue','@Url.Action("GetSearchContent")')
        })
    </script>
}
